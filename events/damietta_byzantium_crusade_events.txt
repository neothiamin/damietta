############################################
# Events for Byzantine Crusades
#
# by neothiamin
############################################

namespace = damietta_byz_crusade

#Demand from the Pope (for Byz, triggered by decision)
country_event = {
	id = damietta_byz_crusade.1
	title = damietta_byz_crusade.1.t
	desc = damietta_byz_crusade.1.desc
	picture = POPE_PREACHING_eventPicture

	is_triggered_only = yes

	trigger = {
		tag = BYZ
		religion = orthodox
	}

	immediate = {
		
	}

	#If the Pope wants the land, he can come take it himself!
	option = {
		name = damietta_byz_crusade.1.a
		ai_chance = {
			factor = 65
		}
		set_country_flag = damietta_byz_refused_to_return_land
		reverse_add_opinion = {
			who = PAP
			modifier = damietta_byz_refused_to_return_land_modifier
		}
	}

	#Ah, very well. The land is poor anyways.
	option = {
		name = damietta_byz_crusade.1.b
		ai_chance = {
			factor = 35
		}
		every_owned_province = {
			limit = {
				religion = catholic
				OR = {
					NOT = {
						is_core = ROOT
					}
					has_construction = core
				}
				continent = europe
			}
			cede_province = previous_owner
			if = {
				limit = {
					is_claim = ROOT
				}
				remove_claim = ROOT
			}
		}
		add_country_modifier = {
			name = damietta_byz_caved_to_papal_pressure
			duration = 5475
		}
	}
}

#Call to Crusade (for other Catholic nations, triggered by decision)
country_event = {
	id = damietta_byz_crusade.2
	title = damietta_byz_crusade.2.t
	desc = damietta_byz_crusade.2.desc
	picture = DIPLOMACY_eventPicture

	is_triggered_only = yes

	#Pledge our support against the Greeks.
	option = {
		name = damietta_byz_crusade.2.a
		set_country_flag = damietta_supporting_byzantine_crusade
		custom_tooltip = damietta_supporting_byzantine_crusade.tt
		ai_chance = {
			factor = 40
			modifier = {
				factor = 2
				NOT = {
					has_opinion = {
						who = BYZ
						value = -25
					}
				}
			}
			modifier = {
				factor = 5
				NOT = {
					has_opinion = {
						who = BYZ
						value = -75
					}
				}
			}
		}
	}

	#We'll sit this one out.
	option = {
		name = damietta_byz_crusade.2.b
		custom_tooltip = damietta_betrayed_byz_crusader_cause.tt
		reverse_add_opinion = {
			who = PAP
			modifier = damietta_betrayed_byz_crusader_cause
		}
		ai_chance = {
			factor = 60
			modifier = {
				factor = 2
				NOT = {
					army_strength = {
						who = BYZ
						value = 0.3
					}
				}
			}
		}
	}
}

#A Catholic Crusade (for Byz)
country_event = {
	id = damietta_byz_crusade.3
	title = damietta_byz_crusade.3.t
	desc = damietta_byz_crusade.3.desc
	picture = DISCIPLINED_SOLDIERS_eventPicture

	is_triggered_only = yes

	after = {
		hidden_effect = {
			PAP = {
				declare_war_with_cb = {
					casus_belli = damietta_byzantine_crusade
					who = BYZ
				}
			}
		}
	}

	#We will win this!
	option = {
		name = damietta_byz_crusade.3.a
		hidden_effect = {
			every_country = {
				limit = {
					OR = {
						tag = PAP
						has_country_flag = damietta_supporting_byzantine_crusade
					}
				}
				form_coalition_against = BYZ
			}
		}
	}
}

#Latin States Once More
country_event = {
	id = damietta_byz_crusade.4
	title = damietta_byz_crusade.4.t
	desc = damietta_byz_crusade.4.desc
	picture = CONQUEST_eventPicture

	is_triggered_only = yes

	#It seems we have no choice...
	option = {
		name = damietta_byz_crusade.4.a
		custom_tooltip = damietta_byz_latin_states_established.tt
		damietta_byz_latin_states_effect = yes
	}
}